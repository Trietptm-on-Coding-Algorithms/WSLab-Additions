$LabConfig=@{ DomainAdminName='LabAdmin'; AdminPassword='P@ssw0rd'; DomainName='cyberdefense-rangers.local'; DomainNetbiosName='RANGERS'; Prefix = 'ThreatHunting-'; SwitchName = 'LabSwitch'; DCEdition='4'; Internet=$true ; AdditionalNetworksConfig=@(); VMs=@()}

$LabConfig.VMs += @{ VMName = 'Member7' ; Configuration = 'Simple' ; ParentVHD = 'Win7SP1_G1.vhdx'  ; MemoryStartupBytes= 1GB ; MGMTNICs=1; AddToolsVHD=$True ; Generation=1; Unattend="DjoinCred"; CustomPowerShellCommands='Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force -Confirm:$false','New-Item -path "$PsHome\Profile.ps1" -type file -force','"(Get-Host).UI.RawUI.ForegroundColor = `"White`"" | out-file $profile','"(Get-Host).UI.RawUI.BackgroundColor = `"Black`"" | out-file -append $profile','"Write-Host Execution Policy set to Unrestricted. Console UI Updated." | out-file -append $profile'}
$LabConfig.VMs += @{ VMName = 'Member10' ; Configuration = 'Simple' ; ParentVHD = 'Win10RS5_G2.vhdx'  ; MemoryStartupBytes= 1GB ; MGMTNICs=1; AddToolsVHD=$True ; DisableWCF=$True ; vTPM=$True; NestedVirt=$true; CustomPowerShellCommands='Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force -Confirm:$false','New-Item -path "$PsHome\Profile.ps1" -type file -force','"(Get-Host).UI.RawUI.ForegroundColor = `"White`"" | out-file $profile','"(Get-Host).UI.RawUI.BackgroundColor = `"Black`"" | out-file -append $profile','"Write-Host Execution Policy set to Unrestricted. Console UI Updated." | out-file -append $profile'}
$LabConfig.VMs += @{ VMName = 'Member12R2' ; Configuration = 'Simple'; ParentVHD = 'Win2012R2_G2.vhdx' ; MemoryStartupBytes= 1GB ; MGMTNICs=1; AddToolsVHD=$True ;Unattend="DjoinCred"; CustomPowerShellCommands='Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force -Confirm:$false','New-Item -path "$PsHome\Profile.ps1" -type file -force','"(Get-Host).UI.RawUI.ForegroundColor = `"White`"" | out-file $profile','"(Get-Host).UI.RawUI.BackgroundColor = `"Black`"" | out-file -append $profile','"Write-Host Execution Policy set to Unrestricted. Console UI Updated." | out-file -append $profile' }
$LabConfig.VMs += @{ VMName = 'Member8R2' ; Configuration = 'Simple'; ParentVHD = 'Win2008R2SP1_G1.vhdx' ; MemoryStartupBytes= 1GB ; MGMTNICs=1; AddToolsVHD=$True; Unattend="DjoinCred" ; Generation = 1; CustomPowerShellCommands='Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force -Confirm:$false','New-Item -path "$PsHome\Profile.ps1" -type file -force','"(Get-Host).UI.RawUI.ForegroundColor = `"White`"" | out-file $profile','"(Get-Host).UI.RawUI.BackgroundColor = `"Black`"" | out-file -append $profile','"Write-Host Execution Policy set to Unrestricted. Console UI Updated." | out-file -append $profile'}
$LabConfig.VMs += @{ VMName = 'Member16' ; Configuration = 'Simple'; ParentVHD = 'Win2016_G2.vhdx'; MemoryStartupBytes= 1GB ; MGMTNICs=1; AddToolsVHD=$True; vTPM=$True ; NestedVirt=$true; CustomPowerShellCommands='Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force -Confirm:$false','New-Item -path "$PsHome\Profile.ps1" -type file -force','"(Get-Host).UI.RawUI.ForegroundColor = `"White`"" | out-file $profile','"(Get-Host).UI.RawUI.BackgroundColor = `"Black`"" | out-file -append $profile','"Write-Host Execution Policy set to Unrestricted. Console UI Updated." | out-file -append $profile' }
